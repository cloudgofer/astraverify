component,rule,condition,points,description
mx,base,has_mx_records,15,"Basic MX record presence"
mx,redundancy,mx_count >= 3,5,"3 or more MX records for redundancy"
mx,redundancy,mx_count == 2,3,"2 MX records for redundancy"
mx,redundancy,mx_count == 1,1,"1 MX record"
mx,provider,has_trusted_provider,3,"Trusted email provider (Google Microsoft etc)"
mx,provider,has_provider,1,"Other email provider"
mx,security,secure_configuration,2,"Secure mail server configuration"
spf,base,has_spf_records,10,"Basic SPF record presence"
spf,policy,spf_policy == 'reject',8,"Strict policy (-all)"
spf,policy,spf_policy == 'softfail',5,"Medium policy (~all)"
spf,policy,spf_policy == 'neutral',2,"Weak policy (?all)"
spf,policy,spf_policy == 'permissive',0,"Too permissive (+all)"
spf,mechanisms,has_include_mechanisms,1,"Include mechanisms for delegation"
spf,mechanisms,has_direct_ip,1,"Direct IP specifications"
spf,mechanisms,has_domain_records,1,"Domain A/MX records"
spf,security,no_redirect_mechanisms,2,"No redirect mechanisms"
dmarc,base,has_dmarc_records,15,"Basic DMARC record presence"
dmarc,policy,dmarc_policy == 'reject',8,"Strictest policy (p=reject)"
dmarc,policy,dmarc_policy == 'quarantine',5,"Medium policy (p=quarantine)"
dmarc,policy,dmarc_policy == 'none',2,"Monitoring only (p=none)"
dmarc,policy,dmarc_policy == 'missing',0,"No policy specified"
dmarc,policy,dmarc_subdomain_policy == 'reject',4,"Strict subdomain policy (sp=reject)"
dmarc,policy,dmarc_subdomain_policy == 'quarantine',3,"Medium subdomain policy (sp=quarantine)"
dmarc,policy,dmarc_subdomain_policy == 'none',1,"Monitoring subdomain policy (sp=none)"
dmarc,policy,dmarc_subdomain_policy == 'missing',0,"No subdomain policy"
dmarc,coverage,dmarc_percentage == 100,3,"Full coverage (pct=100)"
dmarc,coverage,dmarc_percentage >= 50,2,"Partial coverage (pct=50-99)"
dmarc,coverage,dmarc_percentage >= 1,1,"Low coverage (pct=1-49)"
dmarc,coverage,dmarc_percentage == 0,0,"No percentage specified"
dmarc,reporting,dmarc_rua_present,2,"Aggregate reports configured (rua=)"
dmarc,reporting,dmarc_ruf_present,1,"Forensic reports configured (ruf=)"
dkim,base,has_dkim_records,15,"Basic DKIM record presence"
dkim,selectors,dkim_selector_count > 1,5,"Multiple DKIM selectors"
dkim,selectors,dkim_selector_count == 1,2,"Single DKIM selector"
dkim,algorithm,strong_algorithm,3,"Strong algorithm (RSA-2048+ Ed25519)"
dkim,algorithm,weak_algorithm,1,"Weak algorithm"
dkim,key_length,key_length >= 2048,2,"Strong key length (2048+ bits)"
dkim,key_length,key_length < 2048,1,"Weak key length"
